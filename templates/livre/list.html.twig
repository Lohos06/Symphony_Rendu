{% extends 'base.html.twig' %}

{% block title %}Liste des livres{% endblock %}

{% block body %}
<h1>Liste des livres</h1>

<ul>
    {% for livre in livres %}

        {# Trouver l'auteur correspondant à l'ID du livre #}
        {% set auteur = auteurs|filter(a => a.id == livre.auteur)|first %}

        {# Trouver le genre correspondant à l'ID du livre #}
        {% set genre = genres|filter(g => g.id == livre.genre)|first %}

        <li>
            <strong>{{ livre.titre }}</strong><br>

            Auteur :
            {% if auteur %}
                {{ auteur.nom }}
            {% else %}
                <em>Auteur introuvable</em>
            {% endif %}

            <br>Genre :
            {% if genre %}
                {{ genre.nom }}
            {% else %}
                <em>Genre introuvable</em>
            {% endif %}
        </li>

    {% endfor %}
</ul>

{% if app.session.get('role') == 'admin' %}
    <a href="{{ path('app_livre_add') }}">Ajouter un livre</a>
{% endif %}

{% endblock %}